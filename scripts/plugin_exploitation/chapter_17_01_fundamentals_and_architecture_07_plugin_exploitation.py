#!/usr/bin/env python3
"""
Allowlist vs blocklist

Source: Chapter_17_01_Fundamentals_and_Architecture
Category: plugin_exploitation
"""

import argparse
import sys

class PluginAccessControl:
    """Control which plugins can be installed/executed"""

    def __init__(self, mode='allowlist'):
        self.mode = mode  # 'allowlist' or 'blocklist'
        self.allowlist = set()
        self.blocklist = set()

    def is_allowed(self, plugin_id):
        """Check if plugin is allowed to run"""
        if self.mode == 'allowlist':
            return plugin_id in self.allowlist
        else:  # blocklist mode
            return plugin_id not in self.blocklist

    def add_to_allowlist(self, plugin_id):
        """Add plugin to allowlist"""
        self.allowlist.add(plugin_id)

    def add_to_blocklist(self, plugin_id):
        """Block specific plugin"""
        self.blocklist.add(plugin_id)

# Best practice: Use allowlist mode for production
acl = PluginAccessControl(mode='allowlist')
acl.add_to_allowlist('verified_weather_plugin')
acl.add_to_allowlist('verified_calculator_plugin')


def main():
    """Command-line interface."""
    parser = argparse.ArgumentParser(description=__doc__)
    parser.add_argument("--verbose", "-v", action="store_true", help="Verbose output")
    args = parser.parse_args()
    
    # TODO: Add main execution logic
    pass

if __name__ == "__main__":
    main()